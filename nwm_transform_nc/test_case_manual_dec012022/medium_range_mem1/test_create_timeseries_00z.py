from create_timeseries import create_time_series
import time

start_time = time.time()
print("running medium_range files")
logfile = "log_medium_range_test.txt"
output_file = "nwm.t00z.medium_range.channel_rt.conus.nc"
data_variables = ["streamflow"]
chunk_size = 72000
max_memory = 1e10
time_variable = "time"
reference_time_variable = "reference_time"
removed_global_attributes = ""
skip_missing = False

input_files_medium_range = [
    "data/nwm.t00z.medium_range.channel_rt_1.f001.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f002.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f003.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f004.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f005.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f006.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f007.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f008.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f009.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f010.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f011.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f012.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f013.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f014.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f015.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f016.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f017.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f018.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f019.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f020.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f021.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f022.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f023.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f024.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f025.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f026.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f027.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f028.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f029.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f030.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f031.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f032.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f033.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f034.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f035.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f036.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f037.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f038.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f039.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f040.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f041.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f042.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f043.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f044.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f045.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f046.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f047.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f048.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f049.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f050.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f051.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f052.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f053.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f054.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f055.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f056.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f057.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f058.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f059.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f060.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f061.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f062.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f063.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f064.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f065.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f066.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f067.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f068.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f069.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f070.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f071.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f072.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f073.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f074.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f075.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f076.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f077.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f078.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f079.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f080.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f081.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f082.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f083.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f084.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f085.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f086.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f087.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f088.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f089.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f090.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f091.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f092.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f093.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f094.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f095.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f096.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f097.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f098.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f099.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f100.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f101.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f102.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f103.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f104.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f105.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f106.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f107.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f108.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f109.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f110.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f111.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f112.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f113.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f114.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f115.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f116.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f117.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f118.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f119.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f120.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f121.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f122.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f123.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f124.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f125.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f126.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f127.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f128.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f129.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f130.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f131.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f132.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f133.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f134.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f135.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f136.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f137.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f138.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f139.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f140.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f141.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f142.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f143.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f144.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f145.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f146.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f147.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f148.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f149.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f150.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f151.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f152.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f153.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f154.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f155.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f156.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f157.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f158.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f159.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f160.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f161.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f162.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f163.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f164.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f165.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f166.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f167.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f168.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f169.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f170.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f171.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f172.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f173.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f174.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f175.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f176.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f177.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f178.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f179.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f180.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f181.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f182.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f183.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f184.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f185.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f186.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f187.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f188.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f189.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f190.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f191.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f192.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f193.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f194.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f195.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f196.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f197.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f198.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f199.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f200.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f201.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f202.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f203.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f204.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f205.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f206.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f207.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f208.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f209.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f210.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f211.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f212.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f213.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f214.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f215.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f216.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f217.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f218.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f219.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f220.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f221.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f222.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f223.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f224.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f225.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f226.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f227.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f228.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f229.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f230.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f231.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f232.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f233.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f234.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f235.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f236.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f237.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f238.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f239.conus.nc",
    "data/nwm.t00z.medium_range.channel_rt_1.f240.conus.nc",
]

output = create_time_series(
    input_files_medium_range,
    output_file,
    data_variables,
    time_variable,
    reference_time_variable,
    chunk_size,
    max_memory,
    removed_global_attributes,
    skip_missing,
)
print(time.time() - start_time)